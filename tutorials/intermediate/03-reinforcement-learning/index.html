<!DOCTYPE html><html lang="en-us" dir="ltr"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="theme-color" content="#ee4c2c">
<meta name="keywords" content="pytorch,pytorch ignite,ignite,engine,events,handlers,metrics,website">
<link rel="icon" type="image/svg+xml" href="/_images/ignite_logomark.svg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@pytorch_ignite">
<meta name="twitter:creator" content="@pytorch_ignite">
<meta name="twitter:image" content="https://raw.githubusercontent.com/pytorch/ignite/master/assets/logo/ignite_logo.png">
<meta name="twitter:image:alt" content="PyTorch-Ignite logo">
<meta property="og:type" content="website">
<meta property="og:site_name" content="PyTorch-Ignite">
<meta property="og:image" content="https://raw.githubusercontent.com/pytorch/ignite/master/assets/logo/ignite_logo.png">
<meta property="og:image:alt" content="PyTorch-Ignite logo">
<meta name="description" content="High-level library to help with training and evaluating neural networks in PyTorch flexibly and transparently.">
<meta property="og:description" content="High-level library to help with training and evaluating neural networks in PyTorch flexibly and transparently.">
<meta name="twitter:description" content="High-level library to help with training and evaluating neural networks in PyTorch flexibly and transparently.">
<title>
Reinforcement Learning with Ignite
| PyTorch-Ignite</title>
<meta property="og:title" content="  
    Reinforcement Learning with Ignite
   | PyTorch-Ignite">
<meta name="twitter:title" content="  
    Reinforcement Learning with Ignite
   | PyTorch-Ignite">
<link rel="preload" href="https://rsms.me/inter/inter.css" as="style">
<link rel="stylesheet" href="https://rsms.me/inter/inter.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3">
<link rel="stylesheet" href="/_hugo/css/style.3b470591ca1a50dbc1f43747f0bc429f.min.css">
<link rel="stylesheet" href="/_hugo/css/main.9acd436c5609f4c6f7c0a9a9c6536f57.min.css">
<link rel="preconnect" href="https://7EWYE1JCT3-dsn.algolia.net" crossorigin="" data-proofer-ignore="">
<link rel="canonical" href="https://pytorch-ignite.ai/tutorials/intermediate/03-reinforcement-learning/">
<script>const saved=localStorage.getItem('ignite-color-scheme');(saved?saved==='dark':window.matchMedia(`(prefers-color-scheme: dark)`).matches)&&(document.documentElement.classList.add('dark'),document.documentElement.dataset.theme='dark')</script>
</head>
<body class="bg-white
font-sans
text-blue-gray-600
antialiased
dark:bg-dark-700 dark:text-warm-gray-200">
<header class="bg-white
border-b
flex
h-$header-height
py-2
px-6
top-0
right-0
left-0
z-10
justify-between
items-center
sticky
<sm:px-4
dark:bg-dark-700
dark:border-b-dark-200">
<div class="flex items-center">
<button class="mr-1 lg:hidden" id="sideBarBtn" aria-label="Toggle Sidebar"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h7"></path></svg>
</button>
<a href="/" class="flex items-center">
<img src="/_images/ignite_logomark.svg" alt="PyTorch-Ignite" width="50" height="50" class="h-40px w-auto" loading="lazy">
<span class="font-semibold">PyTorch-Ignite</span>
</a>
</div>
<div class="flex-grow"></div>
<div class="hidden lg:block">
<nav class="place-content-center place-items-center block lg:flex">
<div class="p-1 relative group lg:p-2">
<button class="dropDownBtn" aria-label="Toggle Dropdown">Docs</button><svg id="chevronRight" xmlns="http://www.w3.org/2000/svg" class="h-5 transition-transform duration-300 transform w-5 rotate-90 inline-block" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414.0z" clip-rule="evenodd"></path></svg>
<ul id="dropDownList" class="bg-white
border
rounded-lg
min-w-50
p-2
right-0
hidden
lg:absolute
dark:bg-dark-700 dark:border-dark-200
lg:group-hover:block">
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/how-to-guides/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Guides
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/tutorials/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary text-$c-primary">
Tutorials
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/concepts/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Concepts
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="https://pytorch.org/ignite/engine.html" target="_blank" rel="noopener noreferrer" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
API Reference
</a>
</li>
</ul>
</div>
<a href="/blog/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Blog
</a>
<a href="/ecosystem/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Ecosystem
</a>
<div class="p-1 relative group lg:p-2">
<button class="dropDownBtn" aria-label="Toggle Dropdown">About</button><svg id="chevronRight" xmlns="http://www.w3.org/2000/svg" class="h-5 transition-transform duration-300 transform w-5 rotate-90 inline-block" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414.0z" clip-rule="evenodd"></path></svg>
<ul id="dropDownList" class="bg-white
border
rounded-lg
min-w-50
p-2
right-0
hidden
lg:absolute
dark:bg-dark-700 dark:border-dark-200
lg:group-hover:block">
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/about/community/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Community
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/about/contribution-guide/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Contribution Guide
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/about/coc/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Code of Conduct
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/talks/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Talks
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/about/governance/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Governance
</a>
</li>
</ul>
</div>
<a href="https://github.com/pytorch/ignite" target="_blank" rel="noopener noreferrer" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
GitHub
</a>
<a href="https://pytorch-ignite.ai/playground" target="_blank" rel="noopener noreferrer" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Playground
</a>
<a href="https://code-generator.pytorch-ignite.ai/" target="_blank" rel="noopener noreferrer" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Code-Generator
</a>
</nav>
</div>
<button aria-label="Toggle Color Scheme" title="Toggle Color Scheme" id="toggleDark" class="mx-2"><svg id="sun" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364-.707-.707M6.343 6.343l-.707-.707m12.728.0-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg><svg id="moon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 hidden" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003.0 0012 21a9.003 9.003.0 008.354-5.646z"></path></svg>
</button>
<div id="docsearch"></div>
</header>
<div class="grid-cols-[1fr,2fr,1fr] lg:grid xl:grid-cols-[1fr,3fr,1fr]">
<aside class="bg-white
h-$aside-height
top-$header-height
py-3
px-6
transform
transition-transform
z-10
duration-300
fixed
overflow-y-auto
lg:sticky <lg:border-r
<lg:-translate-x-full
<lg:w-75
dark:bg-dark-700
dark:border-dark-200" id="sidebar">
<div class="border-b lg:hidden dark:border-dark-200">
<nav class="place-content-center place-items-center block lg:flex">
<div class="p-1 relative group lg:p-2">
<button class="dropDownBtn" aria-label="Toggle Dropdown">Docs</button><svg id="chevronRight" xmlns="http://www.w3.org/2000/svg" class="h-5 transition-transform duration-300 transform w-5 rotate-90 inline-block" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414.0z" clip-rule="evenodd"></path></svg>
<ul id="dropDownList" class="bg-white
border
rounded-lg
min-w-50
p-2
right-0
hidden
lg:absolute
dark:bg-dark-700 dark:border-dark-200
lg:group-hover:block">
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/how-to-guides/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Guides
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/tutorials/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary text-$c-primary">
Tutorials
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/concepts/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Concepts
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="https://pytorch.org/ignite/engine.html" target="_blank" rel="noopener noreferrer" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
API Reference
</a>
</li>
</ul>
</div>
<a href="/blog/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Blog
</a>
<a href="/ecosystem/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Ecosystem
</a>
<div class="p-1 relative group lg:p-2">
<button class="dropDownBtn" aria-label="Toggle Dropdown">About</button><svg id="chevronRight" xmlns="http://www.w3.org/2000/svg" class="h-5 transition-transform duration-300 transform w-5 rotate-90 inline-block" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414.0z" clip-rule="evenodd"></path></svg>
<ul id="dropDownList" class="bg-white
border
rounded-lg
min-w-50
p-2
right-0
hidden
lg:absolute
dark:bg-dark-700 dark:border-dark-200
lg:group-hover:block">
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/about/community/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Community
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/about/contribution-guide/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Contribution Guide
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/about/coc/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Code of Conduct
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/talks/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Talks
</a>
</li>
<li class="children:rounded-lg children:hover:bg-gray-200
dark:children:hover:bg-dark-200">
<a href="/about/governance/" target="" rel="" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Governance
</a>
</li>
</ul>
</div>
<a href="https://github.com/pytorch/ignite" target="_blank" rel="noopener noreferrer" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
GitHub
</a>
<a href="https://pytorch-ignite.ai/playground" target="_blank" rel="noopener noreferrer" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Playground
</a>
<a href="https://code-generator.pytorch-ignite.ai/" target="_blank" rel="noopener noreferrer" class="p-1 lg:p-2 block whitespace-nowrap hover:text-$c-primary">
Code-Generator
</a>
</nav></div>
<nav class="py-3 px-1">
<h5 class="font-semibold
py-1
uppercase
active">
Tutorials
</h5>
<ul class="px-2 pb-4">
<li class="py-1">
<a href="/tutorials/beginner/01-getting-started/" class="hover:text-$c-primary py-1">Getting Started</a>
</li>
<li class="py-1">
<a href="/tutorials/beginner/02-transformers-text-classification/" class="hover:text-$c-primary py-1">Transformers for Text Classification with IMDb Reviews</a>
</li>
<li class="py-1">
<a href="/tutorials/intermediate/01-cifar10-distributed/" class="hover:text-$c-primary py-1">Distributed Training on CPUs, GPUs or TPUs</a>
</li>
<li class="py-1">
<a href="/tutorials/intermediate/02-machine_translation_using_pytorch_ignite/" class="hover:text-$c-primary py-1">Machine Translation using PyTorch Ignite</a>
</li>
<li class="py-1">
<a href="/tutorials/intermediate/03-reinforcement-learning/" class="text-$c-primary hover:text-$c-primary py-1">Reinforcement Learning with Ignite</a>
<div class="text-sm px-2 lg:hidden"><nav id="TableOfContents">
<ul>
<li><a href="#prerequisite">Prerequisite</a></li>
<li><a href="#the-cartpole-problem">The Cartpole Problem</a>
<ul>
<li><a href="#state">State</a></li>
<li><a href="#action-space">Action space</a></li>
<li><a href="#reward">Reward</a></li>
<li><a href="#when-is-it-solved">When is it solved?</a></li>
</ul>
</li>
<li><a href="#required-dependencies">Required Dependencies</a>
<ul>
<li><a href="#on-colab">On Colab</a></li>
</ul>
</li>
<li><a href="#imports">Imports</a></li>
<li><a href="#configurable-parameters">Configurable Parameters</a></li>
<li><a href="#setting-up-the-environment">Setting up the Environment</a>
<ul>
<li><a href="#on-colab-1">On Colab</a></li>
</ul>
</li>
<li><a href="#model">Model</a></li>
<li><a href="#create-trainer">Create Trainer</a></li>
<li><a href="#attach-handlers-to-run-on-specific-events">Attach handlers to run on specific events</a></li>
<li><a href="#run-trainer">Run Trainer</a>
<ul>
<li><a href="#on-colab-2">On Colab</a></li>
</ul>
</li>
</ul>
</nav></div>
</li>
<li class="py-1">
<a href="/tutorials/advanced/01-collective-communication/" class="hover:text-$c-primary py-1">Collective Communication with Ignite</a>
</li>
</ul>
<h5 class="font-semibold
py-1
uppercase">
How-to-Guides
</h5>
<ul class="px-2 pb-4">
<li class="py-1">
<a href="/how-to-guides/01-installation/" class="hover:text-$c-primary py-1">How to install PyTorch-Ignite</a>
</li>
<li class="py-1">
<a href="/how-to-guides/02-convert-pytorch-to-ignite/" class="hover:text-$c-primary py-1">How to convert pure PyTorch code to Ignite</a>
</li>
<li class="py-1">
<a href="/how-to-guides/03-time-profiling/" class="hover:text-$c-primary py-1">How to do time profiling</a>
</li>
<li class="py-1">
<a href="/how-to-guides/04-fastai-lr-finder/" class="hover:text-$c-primary py-1">How to use FastaiLRFinder with Ignite</a>
</li>
<li class="py-1">
<a href="/how-to-guides/05-gradient-accumulation/" class="hover:text-$c-primary py-1">How to effectively increase batch size on limited compute</a>
</li>
<li class="py-1">
<a href="/how-to-guides/06-data-iterator/" class="hover:text-$c-primary py-1">How to work with data iterators</a>
</li>
<li class="py-1">
<a href="/how-to-guides/07-cross-validation/" class="hover:text-$c-primary py-1">How to do Cross Validation in Ignite</a>
</li>
<li class="py-1">
<a href="/how-to-guides/08-custom-events/" class="hover:text-$c-primary py-1">How to create Custom Events based on Forward or Backward Pass</a>
</li>
<li class="py-1">
<a href="/how-to-guides/09-switch-data-training/" class="hover:text-$c-primary py-1">How to switch data provider during training</a>
</li>
<li class="py-1">
<a href="/how-to-guides/10-loggers/" class="hover:text-$c-primary py-1">How to use Loggers</a>
</li>
<li class="py-1">
<a href="/how-to-guides/11-load-checkpoint/" class="hover:text-$c-primary py-1">How to load checkpoint and resume training</a>
</li>
</ul>
</nav>
</aside>
<main class="min-w-0 py-6 px-6">
<div class="relative prose prose-red">
<div class="flex flex-wrap pb-2 justify-center">
<a class="flex py-1 px-2 items-center" href="https://colab.research.google.com/github/pytorch-ignite/pytorch-ignite.ai/blob/gh-pages/tutorials/intermediate/03-reinforcement-learning.ipynb" target="_blank" rel="noopener noreferrer"><svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" viewBox="0 0 24 24"><path d="M16.941 4.976a7.033 7.033.0 00-4.93 2.064 7.033 7.033.0 00-.124 9.807l2.395-2.395a3.646 3.646.0 015.15-5.148l2.397-2.399a7.033 7.033.0 00-4.888-1.93zm-9.871.01A7.033 7.033.0 002.182 6.917l2.391 2.391a3.643 3.643.0 015.023.127l1.734-2.973-.1-.08A7.033 7.033.0 007.07 4.986zm15.01 2.172-2.39 2.39a3.646 3.646.0 01-5.15 5.15l-2.406 2.407a7.036 7.036.0 009.945-9.947zm-20.148.01a7.033 7.033.0 00-.002 9.681l2.397-2.397A3.643 3.643.0 014.323 9.56zm7.664 7.423a3.635 3.635.0 01-5.017.113L2.182 17.1a7.029 7.029.0 009.007.546l.137-.112z" fill="currentcolor"></path></svg>
<span class="ml-1">Run in Google Colab</span>
</a>
<a class="flex py-1 px-2 items-center" href="/tutorials/intermediate/03-reinforcement-learning.ipynb" target="_blank" rel="noopener noreferrer" download="03-reinforcement-learning.ipynb"><svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentcolor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4-4 4m0 0-4-4m4 4V4"></path></svg>
<span class="ml-1">Download as Jupyter Notebook</span>
</a>
<a class="flex py-1 px-2 items-center" href="https://github.com/pytorch-ignite/pytorch-ignite.ai/blob/gh-pages/tutorials/intermediate/03-reinforcement-learning.ipynb" target="_blank" rel="noopener noreferrer"><svg class="h-6 w-6" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" viewBox="0 0 24 24"><path d="M12 2A10 10 0 002 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92.0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64.0.0.84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71.0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0012 2z" fill="currentcolor"></path></svg>
<span class="ml-1">View on GitHub</span>
</a>
</div>
<h1 id="reinforcement-learning-with-ignite">
<a href="#reinforcement-learning-with-ignite" class="header-anchor">
Reinforcement Learning with Ignite
</a>
</h1><p>In this tutorial we will implement a
<a href="http://www.scholarpedia.org/article/Policy_gradient_methods" target="" rel="">policy gradient based algorithm</a> called
<a href="http://www.cs.toronto.edu/~tingwuwang/REINFORCE.pdf" target="" rel="">Reinforce</a> and use it to solve OpenAI’s
<a href="https://github.com/openai/gym/wiki/CartPole-v0" target="_blank" rel="noopener noreferrer">Cartpole problem</a> using PyTorch-Ignite.</p>
<h2 id="prerequisite">
<a href="#prerequisite" class="header-anchor">
Prerequisite
</a>
</h2><p>The reader should be familiar with the basic concepts of Reinforcement Learning like state, action, environment, etc.</p>
<h2 id="the-cartpole-problem">
<a href="#the-cartpole-problem" class="header-anchor">
The Cartpole Problem
</a>
</h2><p>We have to balance a Cartpole which is a pole-like structure attached to a cart. The cart is free to move across the frictionless surface. We can balance the cartpole by moving the cart left or right in 1D. Let’s start by defining a few terms.</p>
<h3 id="state">
<a href="#state" class="header-anchor">
State
</a>
</h3><p>There are 4 variables on which the environment depends: cart position and velocity, pole position and velocity.</p>
<h3 id="action-space">
<a href="#action-space" class="header-anchor">
Action space
</a>
</h3><p>There are 2 possible actions that the agent can perform: left or right direction.</p>
<h3 id="reward">
<a href="#reward" class="header-anchor">
Reward
</a>
</h3><p>For each instance of the cartpole not toppling down or going out of range, we have a reward of 1.</p>
<h3 id="when-is-it-solved">
<a href="#when-is-it-solved" class="header-anchor">
When is it solved?
</a>
</h3><p>The problem is considered solved when the average reward is greater than <code>reward_threshold</code> defined for the environment.</p>
<h2 id="required-dependencies">
<a href="#required-dependencies" class="header-anchor">
Required Dependencies
</a>
</h2><div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #FFFFFF">!</span><span style="color: #ABB2BF">pip install gymnasium pytorch</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">ignite</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h3 id="on-colab">
<a href="#on-colab" class="header-anchor">
On Colab
</a>
</h3><p>We need additional dependencies to render the environment on Google Colab.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #FFFFFF">!</span><span style="color: #ABB2BF">apt</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">get install </span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">y xvfb python</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">opengl</span></span>
<span class="line"><span style="color: #FFFFFF">!</span><span style="color: #ABB2BF">pip install pyvirtualdisplay</span></span>
<span class="line"><span style="color: #FFFFFF">!</span><span style="color: #ABB2BF">pip install </span><span style="color: #FFFFFF">--</span><span style="color: #ABB2BF">upgrade pygame moviepy</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h2 id="imports">
<a href="#imports" class="header-anchor">
Imports
</a>
</h2><div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #C678DD; font-style: italic">from</span><span style="color: #ABB2BF"> collections </span><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> deque</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> numpy </span><span style="color: #C678DD; font-style: italic">as</span><span style="color: #ABB2BF"> np</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> torch</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> torch.nn </span><span style="color: #C678DD; font-style: italic">as</span><span style="color: #ABB2BF"> nn</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> torch.nn.functional </span><span style="color: #C678DD; font-style: italic">as</span><span style="color: #ABB2BF"> F</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> torch.optim </span><span style="color: #C678DD; font-style: italic">as</span><span style="color: #ABB2BF"> optim</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">from</span><span style="color: #ABB2BF"> torch.distributions </span><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> Categorical</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD; font-style: italic">from</span><span style="color: #ABB2BF"> ignite.engine </span><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> Engine, Events</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> gymnasium </span><span style="color: #C678DD; font-style: italic">as</span><span style="color: #ABB2BF"> gym</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">from</span><span style="color: #ABB2BF"> gymnasium.wrappers </span><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> RecordVideo</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> glob</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> io</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> base64</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">from</span><span style="color: #ABB2BF"> IPython.display </span><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">HTML</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">from</span><span style="color: #ABB2BF"> IPython </span><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> display </span><span style="color: #C678DD; font-style: italic">as</span><span style="color: #ABB2BF"> ipythondisplay</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">from</span><span style="color: #ABB2BF"> pyvirtualdisplay </span><span style="color: #C678DD; font-style: italic">import</span><span style="color: #ABB2BF"> Display</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h2 id="configurable-parameters">
<a href="#configurable-parameters" class="header-anchor">
Configurable Parameters
</a>
</h2><p>We will use these values later in the tutorial at appropriate places.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">seed_val </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">543</span></span>
<span class="line"><span style="color: #ABB2BF">gamma </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0.99</span></span>
<span class="line"><span style="color: #ABB2BF">log_interval </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">100</span></span>
<span class="line"><span style="color: #ABB2BF">max_episodes </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">1000000</span></span>
<span class="line"><span style="color: #ABB2BF">render </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">True</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h2 id="setting-up-the-environment">
<a href="#setting-up-the-environment" class="header-anchor">
Setting up the Environment
</a>
</h2><p>Let’s load our environment first.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">env </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> gym.</span><span style="color: #61AFEF">make</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"CartPole-v0"</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">render_mode</span><span style="color: #56B6C2">=</span><span style="color: #98C379">"rgb_array"</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h3 id="on-colab-1">
<a href="#on-colab-1" class="header-anchor">
On Colab
</a>
</h3><p>If on Google Colab, we need to follow a list of steps to render the output. First we initialize our screen size.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">display </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Display</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">visible</span><span style="color: #56B6C2">=</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">size</span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">1400</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">900</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #ABB2BF">display.</span><span style="color: #61AFEF">start</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><pre><code>&lt;pyvirtualdisplay.display.Display at 0x7f76f00bf810&gt;
</code></pre>
<p>Below we have a utility function to enable video recording of the gym environment. To enable video, we have to wrap our environment in this function.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">wrap_env</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66; font-style: italic">env</span><span style="color: #ABB2BF">):</span></span>
<span class="line"><span style="color: #ABB2BF">  env </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">RecordVideo</span><span style="color: #ABB2BF">(env, </span><span style="color: #98C379">'./video'</span><span style="color: #ABB2BF">, </span><span style="color: #E06C75; font-style: italic">disable_logger</span><span style="color: #56B6C2">=</span><span style="color: #D19A66">True</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">  </span><span style="color: #C678DD; font-style: italic">return</span><span style="color: #ABB2BF"> env</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">env </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">wrap_env</span><span style="color: #ABB2BF">(env)</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h2 id="model">
<a href="#model" class="header-anchor">
Model
</a>
</h2><p>We are going to utilize the reinforce algorithm in which our agent will use episode samples from starting state to goal state directly from the environment. Our model has two linear layers with 4 in features and 2 out features for 4 state variables and 2 actions respectively. We also define an action buffer as <code>saved_log_probs</code> and <code>rewards</code>. We also have an intermediate ReLU layer through which the outputs of the 1st layer are passed to receive the score for each action taken. Finally, we return a list of probabilities for each of these actions.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #C678DD">class</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">Policy</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B">nn</span><span style="color: #ABB2BF">.</span><span style="color: #E5C07B">Module</span><span style="color: #ABB2BF">):</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">__init__</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B; font-style: italic">self</span><span style="color: #ABB2BF">):</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #56B6C2">super</span><span style="color: #ABB2BF">(Policy, </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">).</span><span style="color: #56B6C2">__init__</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">.affine1 </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> nn.</span><span style="color: #61AFEF">Linear</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">4</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">128</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">.dropout </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> nn.</span><span style="color: #61AFEF">Dropout</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">p</span><span style="color: #56B6C2">=</span><span style="color: #D19A66">0.6</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">.affine2 </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> nn.</span><span style="color: #61AFEF">Linear</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">128</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66">2</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">.saved_log_probs </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> []</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">.rewards </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">forward</span><span style="color: #ABB2BF">(</span><span style="color: #E5C07B; font-style: italic">self</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66; font-style: italic">x</span><span style="color: #ABB2BF">):</span></span>
<span class="line"><span style="color: #ABB2BF">        x </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">affine1</span><span style="color: #ABB2BF">(x)</span></span>
<span class="line"><span style="color: #ABB2BF">        x </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">dropout</span><span style="color: #ABB2BF">(x)</span></span>
<span class="line"><span style="color: #ABB2BF">        x </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> F.</span><span style="color: #61AFEF">relu</span><span style="color: #ABB2BF">(x)</span></span>
<span class="line"><span style="color: #ABB2BF">        action_scores </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #E5C07B">self</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">affine2</span><span style="color: #ABB2BF">(x)</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD; font-style: italic">return</span><span style="color: #ABB2BF"> F.</span><span style="color: #61AFEF">softmax</span><span style="color: #ABB2BF">(action_scores, </span><span style="color: #E06C75; font-style: italic">dim</span><span style="color: #56B6C2">=</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p>And then we initialize our model, optimizer, epsilon and timesteps.</p>
<blockquote>
<p>TimeStep is the object which contains information about a state like current observation, type of the step, reward, and discount. Given that some action is performed on some state, it gives the new state, type of the new step (or state), discount, and reward achieved.</p>
</blockquote>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">policy </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Policy</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">optimizer </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> optim.</span><span style="color: #61AFEF">Adam</span><span style="color: #ABB2BF">(policy.</span><span style="color: #61AFEF">parameters</span><span style="color: #ABB2BF">(), </span><span style="color: #E06C75; font-style: italic">lr</span><span style="color: #56B6C2">=</span><span style="color: #D19A66">1e-2</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">eps </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> np.</span><span style="color: #61AFEF">finfo</span><span style="color: #ABB2BF">(np.float32).eps.</span><span style="color: #61AFEF">item</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">timesteps </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">range</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">10000</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h2 id="create-trainer">
<a href="#create-trainer" class="header-anchor">
Create Trainer
</a>
</h2><p>Ignite’s
<a href="https://pytorch-ignite.ai/concepts/01-engine/" target="_blank" rel="noopener noreferrer"><code>Engine</code></a> allows users to define a <code>process_function</code> to run one episode. We select an action from the policy, then take the action through <code>step()</code> and finally increment our reward. If the problem is solved, we terminate training and save the <code>timestep</code>.</p>
<blockquote>
<p>An episode is an instance of a game (or life of a game). If the game ends or life decreases, the episode ends. Step, on the other hand, is the time or some discrete value which increases monotonically in an episode. With each change in the state of the game, the value of step increases until the game ends.</p>
</blockquote>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">run_single_timestep</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66; font-style: italic">engine</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66; font-style: italic">timestep</span><span style="color: #ABB2BF">):</span></span>
<span class="line"><span style="color: #ABB2BF">    observation </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> engine.state.observation</span></span>
<span class="line"><span style="color: #ABB2BF">    action </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">select_action</span><span style="color: #ABB2BF">(policy, observation)</span></span>
<span class="line"><span style="color: #ABB2BF">    engine.state.observation, reward, done, _, _ </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> env.</span><span style="color: #61AFEF">step</span><span style="color: #ABB2BF">(action)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">if</span><span style="color: #ABB2BF"> render:</span></span>
<span class="line"><span style="color: #ABB2BF">        env.</span><span style="color: #61AFEF">render</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    policy.rewards.</span><span style="color: #61AFEF">append</span><span style="color: #ABB2BF">(reward)</span></span>
<span class="line"><span style="color: #ABB2BF">    engine.state.ep_reward </span><span style="color: #56B6C2">+=</span><span style="color: #ABB2BF"> reward</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">if</span><span style="color: #ABB2BF"> done:</span></span>
<span class="line"><span style="color: #ABB2BF">        engine.</span><span style="color: #61AFEF">terminate_epoch</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">        engine.state.timestep </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> timestep</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">trainer </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Engine</span><span style="color: #ABB2BF">(run_single_timestep)</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p>Next we need to select an action to take. After we get a list of probabilities, we create a categorical distribution over them and sample an action from that. This is then saved to the action buffer and the action to take is returned (left or right).</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">select_action</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66; font-style: italic">policy</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66; font-style: italic">observation</span><span style="color: #ABB2BF">):</span></span>
<span class="line"><span style="color: #ABB2BF">    state </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> torch.</span><span style="color: #61AFEF">from_numpy</span><span style="color: #ABB2BF">(observation).</span><span style="color: #61AFEF">float</span><span style="color: #ABB2BF">().</span><span style="color: #61AFEF">unsqueeze</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #ABB2BF">    probs </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">policy</span><span style="color: #ABB2BF">(state)</span></span>
<span class="line"><span style="color: #ABB2BF">    m </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">Categorical</span><span style="color: #ABB2BF">(probs)</span></span>
<span class="line"><span style="color: #ABB2BF">    action </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> m.</span><span style="color: #61AFEF">sample</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">    policy.saved_log_probs.</span><span style="color: #61AFEF">append</span><span style="color: #ABB2BF">(m.</span><span style="color: #61AFEF">log_prob</span><span style="color: #ABB2BF">(action))</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">return</span><span style="color: #ABB2BF"> action.</span><span style="color: #61AFEF">item</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p>We initialize a list to save policy loss and true returns of the rewards returned from the environment. Then we calculate the policy losses from the advantage (<code>-log_prob * reward</code>). Finally, we reset the gradients, perform backprop on the policy loss and reset the rewards and actions buffer.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">finish_episode</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66; font-style: italic">policy</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66; font-style: italic">optimizer</span><span style="color: #ABB2BF">, </span><span style="color: #D19A66; font-style: italic">gamma</span><span style="color: #ABB2BF">):</span></span>
<span class="line"><span style="color: #ABB2BF">    R </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span></span>
<span class="line"><span style="color: #ABB2BF">    policy_loss </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> []</span></span>
<span class="line"><span style="color: #ABB2BF">    returns </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">deque</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">for</span><span style="color: #ABB2BF"> r </span><span style="color: #C678DD; font-style: italic">in</span><span style="color: #ABB2BF"> policy.rewards[::</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">]:</span></span>
<span class="line"><span style="color: #ABB2BF">        R </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> r </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> gamma </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> R</span></span>
<span class="line"><span style="color: #ABB2BF">        returns.</span><span style="color: #61AFEF">appendleft</span><span style="color: #ABB2BF">(R)</span></span>
<span class="line"><span style="color: #ABB2BF">    </span></span>
<span class="line"><span style="color: #ABB2BF">    returns </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> torch.</span><span style="color: #61AFEF">tensor</span><span style="color: #ABB2BF">(returns)</span></span>
<span class="line"><span style="color: #ABB2BF">    returns </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> (returns </span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF"> returns.</span><span style="color: #61AFEF">mean</span><span style="color: #ABB2BF">()) </span><span style="color: #56B6C2">/</span><span style="color: #ABB2BF"> (returns.</span><span style="color: #61AFEF">std</span><span style="color: #ABB2BF">() </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> eps)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">for</span><span style="color: #ABB2BF"> log_prob, R </span><span style="color: #C678DD; font-style: italic">in</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">zip</span><span style="color: #ABB2BF">(policy.saved_log_probs, returns):</span></span>
<span class="line"><span style="color: #ABB2BF">        policy_loss.</span><span style="color: #61AFEF">append</span><span style="color: #ABB2BF">(</span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF">log_prob </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> R)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    optimizer.</span><span style="color: #61AFEF">zero_grad</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">    policy_loss </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> torch.</span><span style="color: #61AFEF">cat</span><span style="color: #ABB2BF">(policy_loss).</span><span style="color: #61AFEF">sum</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">    policy_loss.</span><span style="color: #61AFEF">backward</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">    optimizer.</span><span style="color: #61AFEF">step</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">del</span><span style="color: #ABB2BF"> policy.rewards[:]</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">del</span><span style="color: #ABB2BF"> policy.saved_log_probs[:]</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h2 id="attach-handlers-to-run-on-specific-events">
<a href="#attach-handlers-to-run-on-specific-events" class="header-anchor">
Attach handlers to run on specific events
</a>
</h2><p>We rename the start and end epoch events for easy understanding.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #D19A66">EPISODE_STARTED</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> Events.</span><span style="color: #D19A66">EPOCH_STARTED</span></span>
<span class="line"><span style="color: #D19A66">EPISODE_COMPLETED</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> Events.</span><span style="color: #D19A66">EPOCH_COMPLETED</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p>Before training begins, we initialize the reward in <code>trainer</code>’s state.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">trainer.state.running_reward </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">10</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p>When an episode begins, we have to reset the environment’s state.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #61AFEF">@trainer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">EPISODE_STARTED</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">reset_environment_state</span><span style="color: #ABB2BF">():</span></span>
<span class="line"><span style="color: #ABB2BF">    torch.</span><span style="color: #61AFEF">manual_seed</span><span style="color: #ABB2BF">(seed_val </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> trainer.state.epoch)</span></span>
<span class="line"><span style="color: #ABB2BF">    trainer.state.observation, _ </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> env.</span><span style="color: #61AFEF">reset</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">seed</span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF">seed_val </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> trainer.state.epoch)</span></span>
<span class="line"><span style="color: #ABB2BF">    trainer.state.ep_reward </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p>When an episode finishes, we update the running reward and perform backpropagation by calling <code>finish_episode()</code>.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #61AFEF">@trainer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">EPISODE_COMPLETED</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">update_model</span><span style="color: #ABB2BF">():</span></span>
<span class="line"><span style="color: #ABB2BF">    trainer.state.running_reward </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0.05</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> trainer.state.ep_reward </span><span style="color: #56B6C2">+</span><span style="color: #ABB2BF"> (</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">-</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0.05</span><span style="color: #ABB2BF">) </span><span style="color: #56B6C2">*</span><span style="color: #ABB2BF"> trainer.state.running_reward</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #61AFEF">finish_episode</span><span style="color: #ABB2BF">(policy, optimizer, gamma)</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p>After that, every 100 (<code>log_interval</code>) episodes, we log the results.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #61AFEF">@trainer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">EPISODE_COMPLETED</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">every</span><span style="color: #56B6C2">=</span><span style="color: #61AFEF">log_interval</span><span style="color: #ABB2BF">))</span></span>
<span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">log_episode</span><span style="color: #ABB2BF">():</span></span>
<span class="line"><span style="color: #ABB2BF">    i_episode </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> trainer.state.epoch</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #56B6C2">print</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">f</span><span style="color: #98C379">"Episode </span><span style="color: #D19A66">{</span><span style="color: #ABB2BF">i_episode</span><span style="color: #D19A66">}</span><span style="color: #56B6C2">\t</span><span style="color: #98C379">Last reward: </span><span style="color: #D19A66">{</span><span style="color: #ABB2BF">trainer.state.ep_reward</span><span style="color: #C678DD">:.2f</span><span style="color: #D19A66">}</span><span style="color: #98C379">"</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #C678DD">f</span><span style="color: #98C379">"</span><span style="color: #56B6C2">\t</span><span style="color: #98C379">Average length: </span><span style="color: #D19A66">{</span><span style="color: #ABB2BF">trainer.state.running_reward</span><span style="color: #C678DD">:.2f</span><span style="color: #D19A66">}</span><span style="color: #98C379">"</span></span>
<span class="line"><span style="color: #ABB2BF">    )</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p>And finally, we check if our running reward has crossed the threshold so that we can stop training.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #61AFEF">@trainer</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">on</span><span style="color: #ABB2BF">(</span><span style="color: #D19A66">EPISODE_COMPLETED</span><span style="color: #ABB2BF">)</span></span>
<span class="line"><span style="color: #C678DD">def</span><span style="color: #ABB2BF"> </span><span style="color: #61AFEF">should_finish_training</span><span style="color: #ABB2BF">():</span></span>
<span class="line"><span style="color: #ABB2BF">    running_reward </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> trainer.state.running_reward</span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #C678DD; font-style: italic">if</span><span style="color: #ABB2BF"> running_reward </span><span style="color: #56B6C2">&gt;</span><span style="color: #ABB2BF"> env.spec.reward_threshold:</span></span>
<span class="line"><span style="color: #ABB2BF">        </span><span style="color: #56B6C2">print</span><span style="color: #ABB2BF">(</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">f</span><span style="color: #98C379">"Solved! Running reward is now </span><span style="color: #D19A66">{</span><span style="color: #ABB2BF">running_reward</span><span style="color: #D19A66">}</span><span style="color: #98C379"> and "</span></span>
<span class="line"><span style="color: #ABB2BF">            </span><span style="color: #C678DD">f</span><span style="color: #98C379">"the last episode runs to </span><span style="color: #D19A66">{</span><span style="color: #ABB2BF">trainer.state.timestep</span><span style="color: #D19A66">}</span><span style="color: #98C379"> time steps!"</span></span>
<span class="line"><span style="color: #ABB2BF">        )</span></span>
<span class="line"><span style="color: #ABB2BF">        trainer.should_terminate </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">True</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h2 id="run-trainer">
<a href="#run-trainer" class="header-anchor">
Run Trainer
</a>
</h2><div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">trainer.</span><span style="color: #61AFEF">run</span><span style="color: #ABB2BF">(timesteps, </span><span style="color: #E06C75; font-style: italic">max_epochs</span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF">max_episodes)</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><pre><code>Episode 100	Last length:    66	Average length: 37.90
Episode 200	Last length:    21	Average length: 115.82
Episode 300	Last length:   199	Average length: 133.13
Episode 400	Last length:    98	Average length: 134.97
Episode 500	Last length:    77	Average length: 77.39
Episode 600	Last length:   199	Average length: 132.99
Episode 700	Last length:   122	Average length: 137.40
Episode 800	Last length:    39	Average length: 159.51
Episode 900	Last length:    86	Average length: 113.31
Episode 1000	Last length:    76	Average length: 114.67
Episode 1100	Last length:    96	Average length: 98.65
Episode 1200	Last length:    90	Average length: 84.50
Episode 1300	Last length:   102	Average length: 89.10
Episode 1400	Last length:    64	Average length: 86.45
Episode 1500	Last length:    60	Average length: 76.35
Episode 1600	Last length:    75	Average length: 71.38
Episode 1700	Last length:   176	Average length: 117.25
Episode 1800	Last length:   139	Average length: 140.96
Episode 1900	Last length:    63	Average length: 141.79
Episode 2000	Last length:    66	Average length: 94.01
Episode 2100	Last length:   199	Average length: 115.46
Episode 2200	Last length:   113	Average length: 137.11
Episode 2300	Last length:   174	Average length: 135.36
Episode 2400	Last length:    80	Average length: 116.46
Episode 2500	Last length:    96	Average length: 101.47
Episode 2600	Last length:   199	Average length: 141.13
Episode 2700	Last length:    13	Average length: 134.91
Episode 2800	Last length:    90	Average length: 71.22
Episode 2900	Last length:    61	Average length: 70.14
Episode 3000	Last length:   199	Average length: 129.67
Episode 3100	Last length:   199	Average length: 173.62
Episode 3200	Last length:   199	Average length: 189.30
Solved! Running reward is now 195.03268327777783 and the last episode runs to 199 time steps!





State:
	iteration: 396569
	epoch: 3289
	epoch_length: 10000
	max_epochs: 1000000
	output: &lt;class 'NoneType'&gt;
	batch: 199
	metrics: &lt;class 'dict'&gt;
	dataloader: &lt;class 'list'&gt;
	seed: &lt;class 'NoneType'&gt;
	times: &lt;class 'dict'&gt;
	running_reward: 195.03268327777783
	observation: &lt;class 'numpy.ndarray'&gt;
	timestep: 199
</code></pre>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">env.</span><span style="color: #61AFEF">close</span><span style="color: #ABB2BF">()</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div>
<h3 id="on-colab-2">
<a href="#on-colab-2" class="header-anchor">
On Colab
</a>
</h3><p>Finally, we can view our saved video.</p>
<div class="highlight"><pre class="shiki one-dark-pro" style="background-color: #282c34"><code><span class="line"><span style="color: #ABB2BF">mp4list </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> glob.</span><span style="color: #61AFEF">glob</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'video/*.mp4'</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #C678DD; font-style: italic">if</span><span style="color: #ABB2BF"> </span><span style="color: #56B6C2">len</span><span style="color: #ABB2BF">(mp4list) </span><span style="color: #56B6C2">&gt;</span><span style="color: #ABB2BF"> </span><span style="color: #D19A66">0</span><span style="color: #ABB2BF">:</span></span>
<span class="line"><span style="color: #ABB2BF">    mp4 </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> mp4list[</span><span style="color: #56B6C2">-</span><span style="color: #D19A66">1</span><span style="color: #ABB2BF">]  </span><span style="color: #7F848E; font-style: italic"># pick the last video</span></span>
<span class="line"><span style="color: #ABB2BF">    video </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> io.</span><span style="color: #61AFEF">open</span><span style="color: #ABB2BF">(mp4, </span><span style="color: #98C379">'r+b'</span><span style="color: #ABB2BF">).</span><span style="color: #61AFEF">read</span><span style="color: #ABB2BF">()</span></span>
<span class="line"><span style="color: #ABB2BF">    encoded </span><span style="color: #56B6C2">=</span><span style="color: #ABB2BF"> base64.</span><span style="color: #61AFEF">b64encode</span><span style="color: #ABB2BF">(video)</span></span>
<span class="line"><span style="color: #ABB2BF">    ipythondisplay.</span><span style="color: #61AFEF">display</span><span style="color: #ABB2BF">(</span><span style="color: #61AFEF">HTML</span><span style="color: #ABB2BF">(</span><span style="color: #E06C75; font-style: italic">data</span><span style="color: #56B6C2">=</span><span style="color: #98C379">'''&lt;video alt="test" autoplay </span></span>
<span class="line"><span style="color: #98C379">                loop controls style="height: 400px;"&gt;</span></span>
<span class="line"><span style="color: #98C379">                &lt;source src="data:video/mp4;base64,</span><span style="color: #D19A66">{0}</span><span style="color: #98C379">" type="video/mp4" /&gt;</span></span>
<span class="line"><span style="color: #98C379">              &lt;/video&gt;'''</span><span style="color: #ABB2BF">.</span><span style="color: #61AFEF">format</span><span style="color: #ABB2BF">(encoded.</span><span style="color: #61AFEF">decode</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">'ascii'</span><span style="color: #ABB2BF">))))</span></span>
<span class="line"><span style="color: #C678DD; font-style: italic">else</span><span style="color: #ABB2BF">: </span></span>
<span class="line"><span style="color: #ABB2BF">    </span><span style="color: #56B6C2">print</span><span style="color: #ABB2BF">(</span><span style="color: #98C379">"Could not find video"</span><span style="color: #ABB2BF">)</span></span>
<span class="line"></span></code></pre><button class="absolute top-1 right-1 copyBtn">
      <svg id="copyIt" class="h-5 w-5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="32" height="32" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28 10v18H10V10h18m0-2H10a2 2 0 0 0-2 2v18a2 2 0 0 0 2 2h18a2 2 0 0 0 2-2V10a2 2 0 0 0-2-2z" fill="#fff"></path><path d="M4 18H2V4a2 2 0 0 1 2-2h14v2H4z" fill="#fff"></path></svg>
      <svg id="copyDone" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" fill="none" viewBox="0 0 24 24" stroke="#0f0">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
      </svg>
      </button></div><p><video alt="test" autoplay="" loop="" controls="" style="height:400px">
<source src="data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAPMVtZGF0AAACrgYF//+q3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE1MiByMjg1NCBlOWE1OTAzIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNyAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTMgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MzoweDExMyBtZT1oZXggc3VibWU9NyBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0xIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MSA4eDhkY3Q9MSBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0tMiB0aHJlYWRzPTMgbG9va2FoZWFkX3RocmVhZHM9MSBzbGljZWRfdGhyZWFkcz0wIG5yPTAgZGVjaW1hdGU9MSBpbnRlcmxhY2VkPTAgYmx1cmF5X2NvbXBhdD0wIGNvbnN0cmFpbmVkX2ludHJhPTAgYmZyYW1lcz0zIGJfcHlyYW1pZD0yIGJfYWRhcHQ9MSBiX2JpYXM9MCBkaXJlY3Q9MSB3ZWlnaHRiPTEgb3Blbl9nb3A9MCB3ZWlnaHRwPTIga2V5aW50PTI1MCBrZXlpbnRfbWluPTI1IHNjZW5lY3V0PTQwIGludHJhX3JlZnJlc2g9MCByY19sb29rYWhlYWQ9NDAgcmM9Y3JmIG1idHJlZT0xIGNyZj0yMy4wIHFjb21wPTAuNjAgcXBtaW49MCBxcG1heD02OSBxcHN0ZXA9NCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAABo2WIhAAz//727L4FNf2f0JcRLMXaSnA+KqSAgHc0wAAAAwAAAwAAFgn0I7DkqgN3QAAAHGAFBCwCPCVC2EhH2OkN/weGVAAoD+Tf/UBEHTHT5d/yQiZHO4sg6+zQfs3HI2Y6XZYIRxBm5Rlw5hOCDQtMmgo2zuuFRyAkCAT+9j690O9LdX0vkvSqb33AZdOYYH7qaRR/tss5WLh8ulT532CFFEYvMzRgs0s8puGOPMhBR0ZjRCW8Z0rqEtwcL9cej4Tk0hBdUxtF6hnpsebLADA8EaUwpllZJh1QzIU7mYScNFckSg8ukbIRgWC1k53wt0SdRltJf2UgmeZjrPUL+px4bsCwAANsDZb3yTd4pfYTs10+T+Bo5uRJ/KzPNL/Dl8z0NKih4yPyuG6fePzY78gELZMKQ27ehFW31ciOsjpztaP2rVHecHBjejCGd0wzUpD/u6OqxJqdL87mtINCCr8neNMoDC9WvVXKyTBKAFCrxEQfLcU8HTRE3Ck5zf2gVRQHUh/T7+0L+3yetgpnZIGCACZrLQx6+QD2QAAAAwAAAwFjAAAArEGaJGxDP/6eEAAARVIuQCa1e8Eic9WotG35y8Q22j4UouROtaSMnaJLdLavH2fycnWQPwrafbUfl48e41mxkGK3Qt9e8wwm35F6tDBYIiI/koi0C8FMYJ3g7ukfZJYhve/Kb766Dv34568eUzLhIrKYYmLUg4T6aE+s4Jjtd7byju4MjPErcjhiX9+CF436E01SsTSpDYACP0RX9n/UOI6Vkhw7CQurLEoh7bAAAABWQZ5CeIR/AAAWtVlaQAKTPCg0DVgYqXZ6OIpzjPnX2+y1JZ4MgCJlIme0nlmZTkDBfp3Ct7I5ZUXzGRX4hWo6EVGpt2NvYHRchgAAAwFxQA94rFGuhvUAAAAzAZ5hdEf/AAAjrD5s3sFKk+VnV4vXc7FzsfQ5Lnj8WFT8AAADAAADAAwSiXjxUBVUr4eAAAAANAGeY2pH/wAADYKPU6xylyxViQ+s11+cJeAD+W5v72eOFilaROEiKNBlfKAAAEfhWNYQEjEAAAChQZpoSahBaJlMCGf//p4QAABFaPF1IfbdaPFByIflDUWEq1zqY70u+RQhPS4fY3dh3MIR1IGmhhqoCOE4XbCWcqgilvFr0SvIZP+sJEhPzcV8p8ny+s3etVL3MlrbXWl/x27jypNHnIwBFEh+m5q0CGn3fsSDtN/dR4voXp7WHcbGDxyTJ7atLcKIbna2TarfFZMps87XtF5JM7kZdKZ6OxEAAABAQZ6GRREsI/8AABa1WLR4pbUi6N8osAHAXCQghsP4oJQnAQgtiyImWnIg7CqjmJj9Bx+rurfZ9OoF2cKedW8JOQAAACkBnqV0R/8AACPDO/XhaOun9ZGzdLnuaJyOWHHYOJ+ApwfC6PNlg/4DUwAAACMBnqdqR/8AAA2CMPxFtfwu6fCj0PCnH892M3Ww0RAFDCAu4AAAAJpBmqxJqEFsmUwIX//+jLAAABqh8jIkAZs/FJj8RPb9jF68sePFRWvgjrAgrgK4WzA9bJta/jdj4s2BJ62oA0e6/oZVHQ9yNBMN/R869//M0EF+GsnMUdYapNj/1e50skXttNN4BTT8fcfmRgRQcLDpWG8tbTGxebdyWRIoQGO2g+r1EpoS6bQXTTnWN9VvSAaf4AwSbN1A4EFAAAAAP0GeykUVLCP/AAAIcIWMZl6CnOqysvZock1EQY1v5LuFPp4FMALUilvLiPr853Ne64RhgUJFrKX868XkqbGc+QAAACkBnul0R/8AAA1/RQ0pJAKSzGxaeBBblT2kMyYHDj7J6J/anq/5HdAi4AAAACQBnutqR/8AAA2FkDFmbJNfw8hbwYb4bxJjMHbPjMdnUlKYyoAAAAA+QZrwSahBbJlMCF///oywAAAaD+WNCcfaei2OHtsxniP2CcBX9ceVhjq1yqBlJDPK88i4uVY0ktc3zgW5jAkAAAA8QZ8ORRUsI/8AAAMDOWQNB5ognlJkCHa8mQEAlTEHhjpDgFC30Masci/YPgAkn6qGM/pdYfhlXCbOU/thAAAAMAGfLXRH/wAABPpwJbdm0rJGu5QkGeW5dLkgAH7dBYFs/8LpfnDU2e1X7uVGCxChMQAAACwBny9qR/8AAAUeWLkQP8llceZYccYBr6XAqNABMwuf/8T0Cw+q3TpuUaMHgAAAAIJBmzRJqEFsmUwIX//+jLAAAEYkG7G0BnwB65nwYZqk0zxZzEDIcop2YEhhQQRExJdgZm1WbgXGu1m2fxxSQ0h618RJxg3AX7zBiMpywLofU6KaqAzone74CtjdxpGTDvut9GncjWouu16xTy6LbIZajQBW1pWJ5j2kgvLTNP+rEs+YAAAARkGfUkUVLCP/AAAWp0JTlAAcba7OehKVjYO5ncvDZ2sVDfZfmVtbLikcLsMhr3foT7dulVc6e785F2AfvPVz+WzOkHKJ/+kAAAAfAZ9xdEf/AAAjq/houCzvaW5zUHF9NidozPU0VcsKmAAAADQBn3NqR/8AACOxzA1eLPEjwmjm4t/aW7ZnPM5nCp/K8p++AEr6D9z7oeTE/X/sHE7QLfIwAAAAbEGbdkmoQWyZTBRML//+jLAAABqtZ6e4J4AhP4hY/Gx+sO6dl9Y9pro88SpLj3SSbhj7b1oz4XqKVUswQLppqcKkd803s2XSnhrxOITuT1B6of4lx3qRKe22OpE+WLqweh/XVrD+VjYZPr5TAwAAADkBn5VqR/8AAA2AvAgAuolaIfmqm1hJ0iCoknMbEBnyAyCgnKp5TSHOV6Wpf0iXv9TKTwR4ccyTdswAAAA+QZuXSeEKUmUwIZ/+nhAAAEVFh6QAcm0KK9NMuQgBM8paQJwI7rv3NUrzngueAf4N9RAhW5UqtoDqv/1d3H0AAABXQZu7SeEOiZTAhn/+nhAAAEVFJZT8GIBmaHadINjiXnR+0qhTismpq6Gy7JVH011L+fgKMslabJt9mTgDtub25XH1acfjlZaIvPa0CLaDzoQKc14V6oMrAAAAO0Gf2UURPCP/AAAWwFoFgOX9xG9C9xtkJ21LfVeoMTnh8Yi+qiAy2QFUjr4UVMbKYN/znTYg7+3dGwUfAAAAIgGf+HRH/wAAI8M5bEd4dauJ1RIpNZxXWdc1eJNbg0wajukAAAAyAZ/6akf/AAAjvwQn2/7N1idiIA+x2LC/5RtwWLJvO9NAAPwrkYxrfvtmB6Z9vQRj44AAAABEQZv/SahBaJlMCGf//p4QAABFUQ4vBTca+16bh9YLJ5yWvP9+17gqBXEqwH8yO/hwwMbp2hOpQmsAGlS5XLaTPxePlTEAAABFQZ4dRREsI/8AABa7lD5e8OfcJ6P3Y6crmBr+QTiMs3gpUje3dMEIsjtMAC6gujf2sVXD20LDYzvHHazOXby2P2rUttsxAAAAKgGePHRH/wAAI8MXZCx3tSK11UPCCVvoog1+/rXsEiOjbbvbqYZcFejkgAAAADYBnj5qR/8AACO/Gm3MM157C6QZuPbjtpquVRiJGjQjYPCM/5QAmTPy713Qv72VHYCuuOXv23AAAABiQZojSahBbJlMCF///oywAABGAjRyAC/d5fW6FrcAU8rUOJjKQZ6cIbGLx3zUeG4FniOC59p7fMohH7CFwmViw9cZjZCrFBcGRRq3FjMqe51nYzc3pBR0uhRHFqDXqg28UfcAAABAQZ5BRRUsI/8AABbAWgIHK2fnA/faWtQAw7g7aceKhaA4chN1+tENnwANhvKg2TP1gKiSQwiOCg4o3cOiJbm/BgAAADEBnmB0R/8AACK39g73qr0yH7R97n91TccMDO9CUJpiXXi/fgAS/ufl0dOntmfEcduBAAAATwGeYmpH/wAAI8cynvkueFTwRG05bYAFnE30b3x1Y6IZLmXYaBQNVA/eUg4z3j35a76lZxbzYH+54FNdw/lWB8o3T9NsEv0oxQ7GzifY3gwAAABMQZpnSahBbJlMCF///oywAABGFEFWGR+wQFBP/b6aHgfsOjSVqI+S0PYZINJjuVLsF4egqEB4FPOZt0UZ/lYBQCjUCzVcCaenFmHFgQAAACxBnoVFFSwj/wAAFrMrtQW5HIHyD6jH2R1xoA4YxPLqDzIsUjNu2hJ/KC1bZwAAAE0BnqR0R/8AACOsORx+AFvErPdR6k1zIzgHFkw3rTJI+LTexxIO6wBVNYGfh1Ps6ISioUjKMpFZac4zCG98+M2/+KfEkCJyZjdk75z7ZwAAADQBnqZqR/8AACOyK2H4Abrl29x2R75pNsuCNWPUZsMorEx+jO6m6uUhDAFTXH9W3A2KD/BhAAAAdEGaq0moQWyZTAhf//6MsAAARnpvPcOkWABf7ajIJmRjcbvtckIIJfEDpPzLBUfn0vmUyZjL2YgCrX91mQtKAOmeXtGIn76lkcmweh9xRI6Vgcah/ANxinDlTn3RjXHyQHUTAr+jo1+chugF/RkTXBi6XSTcAAAASEGeyUUVLCP/AAAWu5xRlb+TC22oT4ipg+WKevONPgkNibOWap9tK51xb9ncKCnqlUq7+aTgEhrUrhuRpnsp+tJJcr2zuJ6W3AAAAFcBnuh0R/8AACPAuIaDOtHQA4LYGmzhQhC+Ihfa9RmFZ59ffPj9Fm5ldhbEUvvVuFFhmzhHS54TIREV5BYxsKLxjgHI/1Gtl4rhio8HQ9UqTAc6vcUOds0AAABXAZ7qakf/AAAjscENx2ivRYAAIetMlsMQzifvGsgRyb7nlcsUekqF1GXonb9fwxBDFct0rh8KdiJ04UZOTF0EbDuWz8VxTIVmzfgixZJOhcDqn/Z8XxeDAAAAWUGa7EmoQWyZTAhf//6MsAAARBRBXNXya/5+gPZoihjRO0r62s9mvzAu6isD1spjkv5TCYs1BE3sW+pEHVd/Kcl4IL8dW7xo9ecR2FCHliDJJucw8A6FCO9CAAAAPkGbD0nhClJlMCF//oywAABEAgX8xvm9ynoPdp2fiZ8FIoIARm3OqxZD/TaxtThxq/r+rEctLcc6Hxv/asGBAAAAV0GfLUU0TCP/AAAWMFoQZ4XQQAlpnXj/y/tTIwpFrgT9gAxTP2lhTLWdK7P2mqbh9vB4eH5v49RaIQDiDMNTy+VMpjlZ+GlKp14sHp0cwalgripxCU+FtwAAAEEBn05qR/8AACK9ln67sI7A/RQAWcTgBzjo/LozJGuM9mahaLHDH0TFvbNKCi3ZnkL4f9whCxV4ll/jwo36GVZSAwAAAElBm1JJqEFomUwIZ//+nhAAAENEanOn5fKByFcKjkkHK0UP0z12ACyFoVidY8ttnUjpTfhmCcNu0wNPnVwtx5phctURqrgrSfrCAAAAR0GfcEURLCP/AAAWMEaSExwiDDTOESbHe0gIrkAH1kF5SBzxJE5ZO1ipPRAIYf0bYMtvDNR0oCtlvSOx02WnVFJVEkAUAVGAAAAAOgGfkWpH/wAAIr2Wfruwjpiz3wAWQl4efX2x/xx7mWCYQRLA8NperpYsCfUhjDejKVtpaDI/ebXxck0AAABUQZuWSahBbJlMCGf//p4QAABDZAbY5EAZx11XFCqqzNy5BMhtGa2/st1QOtRNDE5UbzavElO0gI7BKmt8GfpDo7/9Xw4FkLfss0BWatJBvNXX86XwAAAASUGftEUVLCP/AAAWMDAnhAAunghCHWOpCzkpX+PLj3xUA0/BkVbj0XfG3UV6UYaw6ucIis0m5r5vD5fXmt0mA+01xI1kix4y8oAAAAA5AZ/TdEf/AAAiwLj6hQEWgAW8ASAZwvJ942AMTgcGUJnwARd33QGkz2RllMIdKi/am2W2RD50tfzBAAAASwGf1WpH/wAAIscLQKo4zTlvyAAEtRtXm90O60spdzmjt+MCxhns4Y5CBRWea9NSi3W+EDK0jhohBNwvEqPCSdid2Ryxk93Fp1smwAAAAFRBm9pJqEFsmUwIZ//+nhAAAENDlwPFphrdoiM0lmIUyMwuEbfe9AALpTUOsZgtwx8POYNJYcQskskhSLZronz5UWDh71+lv72iZSuFDzYAf4Fz3dcAAABJQZ/4RRUsI/8AABYinqi0PNMwkOUyZjJPOsZgY28g48A5ZkwEH189tnu26PzMmutmU1GYdpE/t2ripeGq/3o2W1Utwj3+xxbegQAAAEMBnhd0R/8AACGsQkV/CAAtRGVQhHEA8ydWL74bDE4cZPg6XKs7/0YekR8/Ryt8rQncct3Kpopa4c6NNH7w/k1Xw+9AAAAAOwGeGWpH/wAAIq4xL9F5PEboAFxrCJLQ/SZZbD0G/qMBQAGQFYjKsqg5SjpSKhDv7j8X3Oc1Qq7aq+k3AAAAZkGaHkmoQWyZTAhf//6MsAAARBROd+y4VLj6/Sl+mPaBvxABbwMI7Ax2B+7fjfwmw3MGCOOhElvuAUGRzqh69k/QRi79SLoVyapmal6SdsC0M61eK5KYVBj6wk4nhpl+jbjHn1lEMAAAAD1BnjxFFSwj/wAAFiKe3jcbRnjlBfKuQrrjNIvNbLycw2neenQH+1xFMxSUYAOTvnK2tvCfBz3Ao7lSPOmBAAAANAGeW3RH/wAAIaxCVOvwAturuHugehKhEoSugMB6pKKF5mQ2z43WEI/2SBHwqydX5hqMqq0AAABBAZ5dakf/AAAirjEv0XlFIKToDeGcAEqFUSo18QBXMnE/32FDOGy/GHHN+lw3jq7f/sHCSUq3i6kltb7fIe6g8EAAAABjQZpCSahBbJlMCF///oywAABEem8/3Gk2MAI96kjuYLS8nHpskEzsQngV3xYe1xV2cNDx+Y5pQgKkDcBSbPjT/OXmAKKrdGE3bzPdlb3zrAE2QlJ26U0hGxqHwti1wOd1vuewAAAAKEGeYEUVLCP/AAAWIp7eNxtHC/l0Ng8oFgZI48BsGI93UUxapZEs1vUAAAAiAZ6fdEf/AAAirBUOC8gZ6PMk+s6SEMT7qtoNP7BlxqMzwQAAACIBnoFqR/8AACKxwQ3H44sHHjGbdxd+TBpW8tBfKoAgGbghAAAAT0GahUmoQWyZTAhf//6MsAAAQhROeTV8krt/gV8ihG9UOuzQRYUSAAh8rR2ueDsckiuOdvAxDcEYmbMAcyZrpm79p2jB6zNfESyE6G3RO0AAAABBQZ6jRRUsI/8AABWSn02wiHQrpPCAyf6o46vXI7aAFSkwlz11+u+BU1pMIfZ8w/EJ8uErlH9VManvSNpfmL+dJsEAAAA5AZ7Eakf/AAAhrjL6/HB0CmwfAAuf3b6xVcUDsEY4q6qNpeFOu8FAe5W6zUg7mbYkVHrNznZvfkLBAAAAY0Gax0moQWyZTBRMM//+nhAAAEFEanSVS6uQAWlC7lDn3LtaH+5hmv6TuYBBfZY3zVGfsNRmODJqws4t9CWaZpu938nDxrP73GAl96s3ZsLNwSF+gOE4DFCgGMJ1NZ0DC5gTTwAAADsBnuZqR/8AACGuM0L+7dCTPaKAC4n9MJhv3LUkQe+AkdtUKTRCiJfPQUfUaRSV7Nx1sL5h+nFFqGsyoQAAAFZBmutJ4QpSZTAhf/6MsAAAQgD4YMAOket8AByu/PcyQ6+/3mrBhwbpuaIVX6EOPeAg/ZG6GX3sq4+ZPfqAt+QuhlmzRp0opXhzpQktdjo74Gzpd3bt7AAAADpBnwlFNEwj/wAAFZKe3jcbRwbjQSyuq0HWRpmyDtwv9sIkZKV3jNaHyUsyIxwPZIqBRrHgxN2XJaHbAAAAMwGfKHRH/wAAIanPZ2q1ZU9mmYYsRj0RftsHuyVnr0bG2ACcM+dOzZJxeEx+jak/HmshFQAAACwBnypqR/8AACGuMS/ReUPCfv+Wqawnx0rNMygBLC11nc8VX8TuH9wb8eBdxwAAAHFBmy5JqEFomUwIZ//+nhAAAEFEd8WQACq4P+WOjjjcGHJXIk8OKxhuXTK69CWDvv/9NpfZKxY8SkchVgVx1iTWpL/Xc7coAeLzHzv6nnKCKBdcvKpipXt0gDRlIUOmw1rcQNDFGgUlhyx9FkNP/RMQgAAAAClBn0xFESwj/wAAFZMrtQji+8fiSk3hv+fKSVyaEvaKPixkPO8iMSbuOQAAAC8Bn21qR/8AACG5wVHZTN8HlCxG4s42AED10Y7r5xEDTrxRNYpVd8rymfaHI1ryYQAAAD1Bm3JJqEFsmUwIZ//+nhAAAEFD1Ti4wzObzRT1ZCxK2WuifIiVzBUnK1oPZAq96bS5EGAG03C/qFJ5yFCHAAAANEGfkEUVLCP/AAAVkp7eNxtHC/l0iDe/8AQ7d33U7WdBbpPDeCRRdnyvLR0jC7l//ki5rXAAAAAmAZ+vdEf/AAAhwLjfwV6R2pnOmTkd2kjniEEpEDOqW6xFKBmu7kgAAAArAZ+xakf/AAAhrjEv0XlDs822QSHvPABwSvIra4CLWcLnW3e+doq6BBdO2QAAAFJBm7ZJqEFsmUwIZ//+nhAAAEG6bz28sUJY2SC6t11oewyduq6Wlb3Vckc/TqoP0LZ0WQACIigfjNxlqBAhwW6F/cDKR8/AZCfp3ics8CCZRcpgAAAAL0Gf1EUVLCP/AAAVlSX9TKsOQVj1Xt6N7o3+G6sCVBsUuEDbbT0afZjUVNYGwCHTAAAAKAGf83RH/wAAIawVDguyIH209OgoPC9R9KWiOaKkQAl1tZiNkdUD8mEAAAAvAZ/1akf/AAAgrjL6/RCM2OwIg/b+zwAsInADnHR+XSRKnleiemg1r/hoJyvH/ZgAAABeQZv6SahBbJlMCGf//p4QAAA/djnAQb8ft2mEUAAaDckyKuL4Q0oiHz5wPtYX12u14dCODo7YKjc4wsSmOXfivk4yB8Bb1hfk4twJoL11cmOCli6olHIO/gVhXKguYQAAAD9BnhhFFSwj/wAAFQKfCdEqn6K0BROjEZAAfzqWBLfySlQuijTFSIR9uGJTlIrLCzOVQCKA2VYQFCm1bdTNDH0AAAAlAZ43dEf/AAAgwLmhvBo6rIUdGki3+rBTQb75QRwgBM/QfVNWZgAAADIBnjlqR/8AACCuMeJ1oq+LPLPQAtWAYHeA6HuMq58zJcPOTibTZ+QQvKQyJQ+x2rTP0wAAAFxBmj5JqEFsmUwIZ//+nhAAAD9qcM2vY0AoQIBmg9aQN+TX3pSy+jFsIGMLaD8pBlX/5ADttdiAeyQmR8eFKejhzhfAFwP8qS7ljzwuSDLLHS8syqw661CXDGjHlwAAAC1BnlxFFSwj/wAAFQKfBgE0gaEUToAAupll7hQEY5CdLkqtmUjRiqmEh/B8BH0AAAAiAZ57dEf/AAAgn0772nBPb3ro3FK8dS6q4JVoh3cwdeaVYQAAACIBnn1qR/8AACCuMjaqdgxYwgtJjOha08G/ODFDOm8RVIWYAAAAbEGaYkmoQWyZTAhn//6eEAAAP15wzmnJ6cAgFtPxJsNJ+jGVCJ9hxUkGGZOIKwmrkUKGeCWb9ajNhwAPkCwlvxrdWtPTyfyM9j3s6gDfyTsn9BsgyYIWmnVPbvu4OFi+N563+Uu2VYZoRj+RsAAAACpBnoBFFSwj/wAAFQtfddP78cmkF0gGvHgzxFSEHd1SS1MlwykvGSu8s9MAAAAzAZ6/dEf/AAAgwLiE+/I8ZqIl6JN1ueJk1gAlim33tv/efo/qiITwTzd7zu7KlzezXHpgAAAAJAGeoWpH/wAAIL2WAooA+ycE7kb31/rZLqqce/zy9bDS9U55QQAAAFVBmqZJqEFsmUwIZ//+nhAAAD+8JzrOJB0jK+jNFrCuA8sbhOt00563RpZu6WSGmwf4MTddLdVNu66nkqsVd65MwFuHb4vxreGDZqIDB4W1vA39mFouAAAAK0GexEUVLCP/AAAVBSX9TKsOQ0v2pp42w5qrsCnBZrgiPmCYRUJtFdbKR6cAAAAqAZ7jdEf/AAAgwLjfwV6RZRRFZYjr8URXGAjwAC6GDqBPUMp6rUwIJg9NAAAAJwGe5WpH/wAAH7mn/7UuCnaLUZlT0VlDvcdFEksmpVQaVAikBrT1mwAAAERBmupJqEFsmUwIZ//+nhAAAD3+RIsAAug3c70FqNJe1JuojCt+8Eusl924Kmf/oWzRh+ICwBRErGcjTPYssZ9AJLmjCwAAAClBnwhFFSwj/wAAFHtfcMr1bAjHM4Mpc2O2rglKeofDl74EMLUMbEaMwAAAADABnyd0R/8AAB/Iyvfw9p3rPDTfAAtu91OxGXYQu+ryK8yrU7+QO2F9AXOrVvK65GAAAAAiAZ8pakf/AAAfxsBoo+KTjb/c61YrykxMDDv57eNW07uO6QAAAFJBmy5JqEFsmUwIZ//+nhAAAD3+dZDFABExtarKmRL24f5t6YRGw+/hi6EJf9xUwNd9zII8AC0sXtZFcrfRPqJiQ8v2SKto2FCO6wn6pIFTn0yZAAAAKEGfTEUVLCP/AAAUcp6otDzTwY+SKuqaNdSeZpD4RqFTqQRli5UxfaAAAAAmAZ9rdEf/AAAfyMpuEn16nRbZcoxGMkVdq/xQVwPe3sx8FN+/cs0AAAArAZ9takf/AAAfzjE/VRxml25QAlhKnHtiSSMCOjWGa5dV/wJaRS8J2flAGQAAAHZBm3JJqEFsmUwIZ//+nhAAAD4KcrCHgCdU2e/1VoRnC87duDv4E2GA6urKxiKF1Tb7wTjwCUi2NA074EhhenAMyw95sEU4nwrTDlNJxwVCuMPDtmOPOe9xwt48RAuALt+kpgL4Uc4KiYQMok4r3hXbEPLQ0TCZAAAAJkGfkEUVLCP/AAAUfmMoyIDI4Cngiw5nXRxBThummwcc51Jt95KQAAAAHwGfr3RH/wAAH8jKWRQrZNXZJ9nQMxbjJGL5Xs4t10gAAAAwAZ+xakf/AAAfuO2C+VTIuoDUnGDvIEw3JARJIVHkALcFIajMCRjBtJYYl5ohrEV7AAAAhkGbtkmoQWyZTAhn//6eEAAAPlwnOs4kHSNu8mADoYfcG0AklodvJ0yOvF+HpLkr2DTi/WoEf6mnBYCDgkK+O48b6sAqPI3adXgg5o27H29wMlR5r+l7N1TtSaTfTDjS9gOhDXwyqm8UHBUpx/1C+Pp/m8mkj8evfYpdHagGQuOTsqPTwzWfAAAANkGf1EUVLCP/AAAUdRfZyoRoQVtcpiGPRC3bUKspxmU4SjlwAg4Vtc50v+qrRx9Erzy3wQpbugAAADABn/N0R/8AAB+26Pagljd1YsHg/5p0+lppoASyljB68YBQUVtgFokd2Qw77nqOt3UAAAAtAZ/1akf/AAAfFsDLu3ncf/zC6J3xRIWUpKv43RIm1syHPTcU5PEDqTPX73dAAAAAa0Gb+kmoQWyZTAhn//6eEAAAPMi37v24tyRbl6kvp5AupNFq7vveMkwAdaUsAjs8Aj0iqNgbNSigLsgZiVPiBMPlvGA+frYf0gHUxgTKIFwY+t+QI0h9oe841Ha9mI0H83gkHHvY3sBFoX7dAAAAOkGeGEUVLCP/AAAT4p9NsIZn1L0AT//P58AewdXOYloMHKcAAakDWPU1pMDDixhq9R729utZAs4kcoEAAAAoAZ43dEf/AAAfBul7r6bpwon+nmEGZ50IatHmGHToc8Nmfxczuuq9owAAACwBnjlqR/8AAB8Jp/+1ETxXvC/Uq5VAYxvB1NhNrMAnzUnI1gLw0GHqJx1ggQAAAGVBmj5JqEFsmUwIZ//+nhAAADyecNdGzgKxZ4jI2Gtk8bWEEaFT5u7qoMcBSGSsAF11yBjxOagenryL//K3gv/+ydye4aFFqYzy6DO1YC0XsQ3hcCitNyBSqcy39WJWsNGbdFgzoAAAADlBnlxFFSwj/wAAE+KeqLQ809LKPU8O6hns3sZhQ9okJ5Mr0Kk2fpssogBKkAioncRH4f4WP0LV/SEAAABAAZ57dEf/AAAfGMpZFCtlKdRwvOZS4+P3rpj3m0DwbQ8CkQRIRNWC1zT9FUACcM9tVGXZmUDpT89dOin+T9FPSQAAAEABnn1qR/8AAB8Jpn9ReUOz2oR6e+1+wO/JuiqsDUgMrb2Em+npowRe0oAE4MBHVv8R+B5V7RwiYD4yUD6nWsMcAAAASUGaYkmoQWyZTAhf//6MsAAAPPyDM47QHVGoD+J1f8wn+J7KMANxDRs1DfrSSKthyVvHK02QOcSLWjsa59IsQ70664whvzwDQRMAAAA8QZ6ARRUsI/8AABPint5UhAA6A42w0AuwU7lJdI3VtXf6JSWbtzXntX/g0P7jZMgGQp9SxfllrG2tlFmhAAAAQAGev3RH/wAAHwbo8U9tKeKWX6ix17Ag0UZtrItddZp77kpcmadanuaUP3QAP3HhckFBXheGoIvXLbyk3vkSFmgAAAAqAZ6hakf/AAAfCacF4DyMs1su/B0wN9UNGyUhnMq7hAkN2Sb3wCMVUb0hAAAAbkGapkmoQWyZTAhf//6MsAAAPVwnP2vO4StcqkzssAITon2H64cFUCZ4+qi1jTBTA/bjnysaN8ydqCs+GrvpMpsBjdzVACDiXqinINTq1cU/daE7mbGF+7D+u4fd875tV/7hj70EsfIRLV3Ombs+AAAAN0GexEUVLCP/AAAT5SSh/aVTAFOHyjw9F5Jdk/HIlyiDYd4i7g7HQp4cb3tB8lQZ3cyNnA5O8oEAAAA+AZ7jdEf/AAAfCI4sTENIDm4AOkAhSK9uC6vEWwf1bkTjktkM0pY/j7fllGJ530Psu9EHay6oI8WQR480u9MAAAA1AZ7lakf/AAAeWaf1PVVZQAn3TXmCqkBp8Sqh52aMAXQPLQEmko0GACINNF3/uTWnO7yWg+UAAAB/QZrqSahBbJlMCF///oywAAA7nIMn00u6lvbjWTvcAzk+UP49CZYQbYrQIzdpZRBO2fpodhHdnafdkgV/WJ7M/UONHrHnbGm9p6gS2QvfWUtj6gBDpEUeQOLWG6hBWE2G1FAYwUHJ141LEXuCCXprHzGGnYvw2CcItiBTyCGS8QAAAE5BnwhFFSwj/wAAExzL2oI8sa+sUXACZXjZpqjzqFJQCSWjyKSrIaDJe6tDHFdhiDATUPPgRPygafebsDo3IDXkRdqAuhm3DGo1nrQtuPQAAAAyAZ8ndEf/AAAeTjTqfWWyFJvuzThOcRn77QQcjNqrvAS3/lXZshcKgjm4ylpiGvEbvSAAAAAtAZ8pakf/AAAeWaZ/Uc4htjHru7aXlsShRz/JuGPgVXs0RCdsJK0Omps2n0CpAAAAUEGbLEmoQWyZTBRML//+jLAAADunzMoFd01URoYAIfdmT6bQK0XWcLY7fmEyHxCg9Bqcg5zEXxmUmy/CA6eolC2+FpMCcd6uaPDQJuCXZkaIAAAAQwGfS2pH/wAAHlmmf1HOjTU8woPYEl5rnHIXlY2bVB7ZoUwwUxrAycgA/mL81yMzhb7cAQKYX6LjI3ccW8CGNRPs17QAAABjQZtQSeEKUmUwIX/+jLAAADv8J0U8WtazodAFaGEyEHZTS0IQZqbL8dgYpUKQ9Dtue4ViTcFp8XLjdF2T34PdqLXOdVUY+WD5iN6qZBfd9zghcb+f7MWJd4Yvkr/AW8E/01OBAAAASEGfbkU0TCP/AAATXSVB5W7N1j7cZkqO8bW+MJt3ZPtMkzzb3VN63KcEsZsO6h0rhvWBEsrUPhfaO/VAAXMkZQhjmLHv8Xi9oQAAADoBn410R/8AAB5omOT6sAkKgtI26RACyYOX9gUCpGvamvwo8Xb5VYfyafvF5BH6WAkxjgILBCrMlezBAAAAQAGfj2pH/wAAHlx66hVTsOnKNFPK2pcl5k5o4sHSRe3zuQhm/MtvB4o5KWZQAHvxfbsnYl9fJzMrhSO+EYE3XswAAABmQZuSSahBaJlMFPC//oywAAA6SxNfWcALD6lCaNcKCoKXjLgA0vZ90M0mAxjpfNNRpLk/UFVgLCoW2cHnKBJr057sads6LZx9CwnN0ika2dJfwQqGWjaFY+AR1FN5ccnD4orH+eJsAAAASAGfsWpH/wAAHamn9lZ0vgluHexxxKqyr0AY1Y8L5VU26xrWceLx0cu3KgJdKm6AC0PwByu1MuCyo+mWuSb7fUlEeu3A7NM75wAAAEZBm7RJ4QpSZTBSwz/+nhAAADneQ8ZvQQLIL73zSiOQ1CT/+wh+8mfJXhST+g+fngjfL+fd1asd9j5J1Lv/tyklsJ6IlmjWAAAAPwGf02pH/wAAHbZjbEMV9eSfCMNCNRyC/2MfguHX8Isw68+mQzISSMdXHraaAAe1ofdG35C82U9oPhn00xQgzQAAAENBm9hJ4Q6JlMCGf/6eEAAAOd6LLxtvGvcqQpPMwikZRrGkinz+4qUnZBbosYsPf/Dg5wvvWik904L60/7IJNTJKGyxAAAAPkGf9kUVPCP/AAAS1b477OIRQDlz8NPs9MChlnZxYdgF4fyx0tNSd4gUeo7yVXcRCM2JkBGVUdBQllCo/jXQAAAATAGeFXRH/wAAHbhJ5qSAFYudWyodRFHAjwM7C0Lj0FusKnjq5uojxC7YfbO4W5J4R3jHS9R+tRWzky5DV2XxHltxxiVjkivcgWH2G0cAAABUAZ4Xakf/AAAdqaZ/UQKgTmHSO6I2AAtv3b6xIF1XdS0ZgXWdUI6aACFb7WlGfEBuOq0gAXcOcHlPZXgtGTFl1QFqi5d4QnjBtulGomd24ICESu/xAAAAb0GaHEmoQWiZTAhf//6MsAAAOpwnPdKdFgAOPbUTPkc0dBbbukQI0iBgHkekYbuxQzIsP7VF3tyPS+qC7wrkT+DPuQ9DOop+Q8j+T82axb0XS0cfYmYkb2OcUbC9aP1IPckyNBZ2VxfgpQsJpVSnIAAAADpBnjpFESwj/wAAEtf+ZhpwBaQAKB0VdbeZAupNQ+uPUQXG1tAMNbWOz+NXyeWJ6nsb6XRkjuqDlr7hAAAANQGeWXRH/wAAHbgs/y8T9FPCJ+Q80HnP9FCQ+vQIiD524IvZbnaspI+kqfA5/iqaI1UGyFHAAAAAQAGeW2pH/wAAHQZjjF51LktcqgET7BMllVfAEV1gTYJwsPvHoUWU93kr28utoeEoXIB3mZoAE4msumbto4xNL/EAAABkQZpfSahBbJlMCGf//p4QAAA4fn/xm9DDCjjF0AGwtNsc0l/wl9jZHrE0iVv4lqTZtIhqutVMetbovCxvowjEOuKa/QBYcRgQ8p7oaQ92gwTSo2e6IwgIoMu2AHCdAwTmN4uDwQAAAFNBnn1FFSwj/wAAEmI5t7AQxUADt+fVZrvxt1YQnXei0UiTq6XhW5+2Bq2VSCm1a4uw2e/LK50Up3J9L/AYEV/UGqeEkIdjB1u7pLEz5KeKz5riDgAAAD8Bnp5qR/8AAB0GYybmQ67Q1Kx4pcHG9Esu2YNh6SOmCKABxIxPCV6matin6t5/Gfaa2bVDOgdaF+1I3GdKqJgAAABiQZqDSahBbJlMCGf//p4QAAA43Cc/uKj7Cxw1IkIz0hyVxzIADn4r0ZhbZS8nUMLlfratnlqA2sU5HdA8Ci3DlkRbcgkhEpLqKaEx5mKTRzhej9u5O9RCcCxAlZ+Ejj6LQs8AAABOQZ6hRRUsI/8AABJiPM14j7RoCyDvda+9JOTMoyPiawB9/ubmwje5DueEXJwDkHxSYJOXjK4aWUItxidfYiMRJUPxFvECt8DHggia3ghUAAAASAGewHRH/wAAHQgs/y8T1EoZx8uPP9LORbVq9xGzsDzyfFFtZfxPRyrJmI73QATH44Ac4BPy163lZrBVTN/pMUken7JZ98oAgQAAAEIBnsJqR/8AABz47Ta9GtUn6Qul36fiuisIcFHmCTZxxZVBIUIgmaTK0JYOmGpgA1Gd/xI9X3tqqZYb0F9B5oqTCFQAAABxQZrHSahBbJlMCGf//p4QAAA3K9DnqAIrG+1rXF+JCfpl3gll1MDahwH2nzSjD1wmDIzvGykaUOxovX1rChnOn+TV67be4Id01W+471Ym5fya9/2JmV/K/SNP/AjOX+FJq264vP4AMa9GEx+cmzhN2MkAAABCQZ7lRRUsI/8AABHdNpWQ7VVT7otZ5iASD+Uu/ZP/F2mrepbDr6oPFFiRQkGjK70G+Ie+ZJu+CAFvg2EI1EDWlcgDAAAANwGfBHRH/wAAHFgtVKbfHPJkx77t9pZPV4lceUbu1+jJRN0yqsSwyEPkJL7FjKAT58ZqcwxLwcEAAAAxAZ8Gakf/AAAb9OK0E3VcgIrhcV6zGYGRsS1RQ7/K2KN0WauaKuMLO9XlC10p/nX4OQAAAFxBmwtJqEFsmUwIZ//+nhAAADcr2l+6yMGNVs7gw3HwJJkAWjh9CTIsoOFxOzdE6YhH8xgAjhhTw3IngTECt3g+A4JjN/NqlzvO01DRftU6AnI0xPem9YugujcoKwAAADdBnylFFSwj/wAAEdXgy/8fC+8+7JbVeg05Ldd00+y8yOQ71Jrtu4sFSYghwjOvlkBo7VJYjFgzAAAAPgGfSHRH/wAAHFgsoqStqpW8JukMk8//Ql9k364IRaAIX3Pq1FQpPyYBe55zX2My4AHo2UnO/W3uBte6Wnw/AAAANAGfSmpH/wAAHEjtNr0qNPqBKGq9eMVAAPiEk3+enVwquDdj+kIVC+rS+lBTv2nU0gptsCwAAAB3QZtPSahBbJlMCGf//p4QAAA3fCc61Dd6n5FWgMFSCMfmL2ew79eWdRU1gj3s5D18fhBuw7GqsyMfjNvVWWGFi9nkM9U4snBbpzGVgnxVEJ9WyrpD1VvZ29PyGvpRIw8Xiobf5+Vzh2FwiDn3Yd6RFFhqASfxbkAAAAAzQZ9tRRUsI/8AABHX8RIQSDZ67AE5Kjeu0Y9TZi/7ZYm4ahXZS30l7Cd1MsXzonzpGS+lAAAAQgGfjHRH/wAAHEiNjcYBS8bvUpe8VKWQZGSSOPfKJzD2mGQLwLkddAA2GDnSgpzuzMoTpCqzUTzkDd1p3y7xFmVgsQAAADcBn45qR/8AABucX9ofYBDnrlE8Cyz1+SvdhIIzFcS0h46ac/YXlVzUWUdM0SJwt75BHEtwEV4fAAAAg0Gbk0moQWyZTAhn//6eEAAANfPqHjc9BABIA+ABw3oxbTWEY3Ri3EL5cZ7EtkPz2WxH8pYzYL+WW4nuevgp13P+nVp+4z6Ag98PdrHAs51bp5F0UMGABg/ixIDLhIkmbtIqpspkeKrDbozPFD2pdCQ4YJM1iLs7rK0z6i6zO4upPEEIAAAAPEGfsUUVLCP/AAARXTaUI9mRZx+W7xiVZuVEfge76A3PfDbftpDtu0r96BC55o9D3UkAH5nDdWTEIqEPSAAAAEIBn9B0R/8AABupbbykpq43ap7ICmxizdOFatiiGOoYjs52AD78GeDLPZg9dcUbqbfZLieGlJH08w+JeSvZIbJ8pnEAAAA1AZ/Sakf/AAAbp9p6sSdejr8cIlTpwWzEz/XPvUVDtds7omnwYF7cgvY9ozj3AgSLHPOmavkAAACCQZvXSahBbJlMCF///oywAAA2nrZ+1iMGAHQLPtRFN3b5fLj9kCgkfxL64e401uqfW8CwUiDM1mDYB1I+vvRgGXGRWXLXbRJRJxVTEvgM+F9/5l6Dm2kucL/MxtzYTuKWDQtgfoOsgQt9nBYwfHLWavFgIXsXw0QiWrpYSI0j0oA+uAAAADxBn/VFFSwj/wAAEVgFn1uIoB5mImGA1805/iM6FvMYz8XzpFfpcdf2uqEbxXivSSTB804BLNafbvEQZi8AAABNAZ4UdEf/AAAbm/6xRhEpy8wEUTB/y/h9xcRXJZO4x+vmSGz5Tl6jpe6ABsNl1uJxFJ8QGkoORnzWymp9Oq/qa6oBxodwGq78u+8sKi4AAABMAZ4Wakf/AAAbB9p/J43sIfBdFZs9V8rAUrlxrGCr0GYmbOmY2umzhUa7t+FWKj3oGGm9eHAEYgCRxCKOXtyVjl7/lq729/H/Gs3/qwAAAGBBmhtJqEFsmUwIX//+jLAAADVcJz3VTlXptA97va+w9GD0CPg2/1m+3w1KEVTkfeqTUkHXYfGSZy56AGuig0JmtT4QPQdEh5Tpn8yoUo753kPUZcaBSDa0BBU0kyrurxEAAABEQZ45RRUsI/8AABDiPtvfWvea9kBWPKQDFb0Z4Nd9/yagAIyDTJ8g4QSg2lupJiyERcMP0Oq4ptwSv8QrAm8at1Ixn8QAAABSAZ5YdEf/AAAbCW28pHIB1NO8NcHE0T/bWjTXnbGl7SmRUVzyPIFmtVUt/+ACcM9tVGXZmUC4IHRjjuwVPBqTMlvVJTDxYZSYuUS1P0fGOlqcQQAAAEABnlpqR/8AABsH3zK+AD9hZEu8UFmuYn/rFOSHaUin/K8nXAQJOynSUBVDazwRN8PMNID+tKo80jtOFP+3O+YGAAAAb0GaX0moQWyZTAhf//6MsAAAM9SDxz4oJ6PaKw9f4YNnKKMzsIQIS6gd5sB7fKEk74QEmJJGH+wZgQe/cW4cIDIl9/xd6z3d3nBFC4mFxHFRri3QM5+e5e5UZxISKrGyfP5FFWmpeF+hEIkv6seWgQAAAFBBnn1FFSwj/wAAEByiy/IFjiIAJ7Ftm06WX6UZ9Psje7P8VlNqnVQm5q4U0id3aiI+YsbxTIKiWYacHa5+ApmGaURd+2ycqYXPISUcPwxpgQAAAEIBnpx0R/8AABpjZS+VfvrTWi2dzs2KffAP0m0ZrXUQ7vQ0LtCD6kliDtGpET3cqABtFKJ5VlQd6HRIoUVVxdU9kOAAAAA0AZ6eakf/AAAaXF9j9I27POnU6rk7w3AyJbEkWWPPLLgBZr+ngdghM//WPPaqMMa0XmslIAAAAHVBmoNJqEFsmUwIV//+OEAAAMnv/OLieH1UDNl+/5N6e5gT/MBKQVqi95OFVBKqik2YIQbLff/VjLs9EAQzo7vI6LpSSt3eBggDHkXES1pQtOz1NDiEwfDqAsNwDdzb3Ox+I210AmE1cVqdzd+owBhmCxkDOaEAAABJQZ6hRRUsI/8AABBYBZ/l2js7QgCnywq41WEdIUwSRBwhisz/MMsLUVek/amaZyrq2o77/8LfEY3X64sDUEgcBvn3sUo1QxGGgAAAAD4BnsB0R/8AABpjaLmQGFM27N8OOXEER2x19mjN6P3xQZnFvvv22X99uLzSZAA1Gc/f0T+2t2XSrdjIwCLJHwAAAEABnsJqR/8AABnOmkuISGBjmFeumlA/nlPRh0olNXikCU5u+YVVuWEk5xPuHOv9HM/to4pAA+6p/Uy7mbEvxcx4AAAAUkGaxUmoQWyZTBRMK//+OEAAAMOd/2foJm5QRq0fWVzuBPgN/9pa3/iK9v/vpi50LKLccShL3dPGFiAECFwUCzNv67PUsGSqjAMO7KUG9dbUQVkAAAA9AZ7kakf/AAAZsKhYmUhqCzHdtQMF+bdjS2TNfgvf/V6Nv7Ktd254orIieNZz0rcsWhhxIQWmfVt91NzZcQAAAFtBmudJ4QpSZTBSwj/94QAAAwL/v+vgJt863Y9qOS+6Ao/MxmelgHAGENjDYrSApBgPb3rXptgzeOkgATI9GPTYVV62Xt2FUGRB52mX71xwJ8uR64BXKQ9USjVxAAAALgGfBmpH/wAAGcd7NLN1axEJaPxz9xHBN/2Dd4cQgQh5qh+ZKtUW5AiL1Z7G5I8AAABLQZsISeEOiZTAj//8hAAAC1Iqq23rXjAtaML5I1SNVX+QaA6cQooMA3sAOHgQhGVBABEG5DHy+cQ61DgOdHqxrzzXKxibw+ml32+WAAAMV21vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAA+0AAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAuBdHJhawAAAFx0a2hkAAAAAwAAAAAAAAAAAAAAAQAAAAAAAA+0AAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAJYAAABkAAAAAAAJGVkdHMAAAAcZWxzdAAAAAAAAAABAAAPtAAAAgAAAQAAAAAK+W1kaWEAAAAgbWRoZAAAAAAAAAAAAAAAAAAAMgAAAMkAVcQAAAAAAC1oZGxyAAAAAAAAAAB2aWRlAAAAAAAAAAAAAAAAVmlkZW9IYW5kbGVyAAAACqRtaW5mAAAAFHZtaGQAAAABAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAApkc3RibAAAAJhzdHNkAAAAAAAAAAEAAACIYXZjMQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAJYAZAASAAAAEgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABj//wAAADJhdmNDAWQAH//hABlnZAAfrNlAmDPl4QAAAwABAAADAGQPGDGWAQAGaOvjyyLAAAAAGHN0dHMAAAAAAAAAAQAAAMkAAAEAAAAAFHN0c3MAAAAAAAAAAQAAAAEAAAYwY3R0cwAAAAAAAADEAAAAAQAAAgAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAAAwAAAAABAAABAAAAAAEAAAIAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAIAAAAAAQAABAAAAAACAAABAAAAAAEAAAQAAAAAAgAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAQAAAAAAgAAAQAAAAABAAADAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAEAAAAAAIAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAAAwAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAAAwAAAAABAAABAAAAAAEAAAMAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABAAAAAACAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAUAAAAAAQAAAgAAAAABAAAAAAAAAAEAAAEAAAAAAQAABQAAAAABAAACAAAAAAEAAAAAAAAAAQAAAQAAAAABAAAFAAAAAAEAAAIAAAAAAQAAAAAAAAABAAABAAAAAAEAAAMAAAAAAQAAAQAAAAABAAADAAAAAAEAAAEAAAAAAQAAAgAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAMkAAAABAAADOHN0c3oAAAAAAAAAAAAAAMkAAARZAAAAsAAAAFoAAAA3AAAAOAAAAKUAAABEAAAALQAAACcAAACeAAAAQwAAAC0AAAAoAAAAQgAAAEAAAAA0AAAAMAAAAIYAAABKAAAAIwAAADgAAABwAAAAPQAAAEIAAABbAAAAPwAAACYAAAA2AAAASAAAAEkAAAAuAAAAOgAAAGYAAABEAAAANQAAAFMAAABQAAAAMAAAAFEAAAA4AAAAeAAAAEwAAABbAAAAWwAAAF0AAABCAAAAWwAAAEUAAABNAAAASwAAAD4AAABYAAAATQAAAD0AAABPAAAAWAAAAE0AAABHAAAAPwAAAGoAAABBAAAAOAAAAEUAAABnAAAALAAAACYAAAAmAAAAUwAAAEUAAAA9AAAAZwAAAD8AAABaAAAAPgAAADcAAAAwAAAAdQAAAC0AAAAzAAAAQQAAADgAAAAqAAAALwAAAFYAAAAzAAAALAAAADMAAABiAAAAQwAAACkAAAA2AAAAYAAAADEAAAAmAAAAJgAAAHAAAAAuAAAANwAAACgAAABZAAAALwAAAC4AAAArAAAASAAAAC0AAAA0AAAAJgAAAFYAAAAsAAAAKgAAAC8AAAB6AAAAKgAAACMAAAA0AAAAigAAADoAAAA0AAAAMQAAAG8AAAA+AAAALAAAADAAAABpAAAAPQAAAEQAAABEAAAATQAAAEAAAABEAAAALgAAAHIAAAA7AAAAQgAAADkAAACDAAAAUgAAADYAAAAxAAAAVAAAAEcAAABnAAAATAAAAD4AAABEAAAAagAAAEwAAABKAAAAQwAAAEcAAABCAAAAUAAAAFgAAABzAAAAPgAAADkAAABEAAAAaAAAAFcAAABDAAAAZgAAAFIAAABMAAAARgAAAHUAAABGAAAAOwAAADUAAABgAAAAOwAAAEIAAAA4AAAAewAAADcAAABGAAAAOwAAAIcAAABAAAAARgAAADkAAACGAAAAQAAAAFEAAABQAAAAZAAAAEgAAABWAAAARAAAAHMAAABUAAAARgAAADgAAAB5AAAATQAAAEIAAABEAAAAVgAAAEEAAABfAAAAMgAAAE8AAAAUc3RjbwAAAAAAAAABAAAAMAAAAGJ1ZHRhAAAAWm1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAALWlsc3QAAAAlqXRvbwAAAB1kYXRhAAAAAQAAAABMYXZmNTcuODMuMTAw" type="video/mp4">
</video></p>
<p>That’s it! We have successfully solved the Cartpole problem!</p>
<div class="pb-2">
<span class="mx-2 inline-block">
<a href="/tags/rl/">
#RL
</a>
</span>
<span class="mx-2 inline-block">
<a href="/tags/intermediate/">
#intermediate
</a>
</span>
</div>
<div class="border-t grid py-6 gap-x-4 grid-cols-2 dark:border-dark-200">
<div>
<a href="/tutorials/beginner/02-transformers-text-classification/" class="group"><svg xmlns="http://www.w3.org/2000/svg" class="h-5 mr-1 transition-transform w-5 duration-300 inline-block group-hover:transform group-hover:-translate-x-1" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414.0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd"></path></svg>
<span class="overflow-hidden"></span>Transformers for Text Classification with IMDb Reviews
</a>
</div>
<div>
<a href="/tutorials/others/" class="group float-right">
<span class="overflow-hidden"></span><svg xmlns="http://www.w3.org/2000/svg" class="h-5 ml-1 transition-transform w-5 duration-300 inline-block group-hover:transform group-hover:translate-x-1" viewBox="0 0 20 20" fill="currentcolor"><path fill-rule="evenodd" d="M10.293 3.293a1 1 0 011.414.0l6 6a1 1 0 010 1.414l-6 6a1 1 0 01-1.414-1.414L14.586 11H3a1 1 0 110-2h11.586l-4.293-4.293a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
</a>
</div>
</div>
</div>
</main>
<aside class="h-$aside-height top-$header-height py-3 px-6 sticky overflow-y-auto <lg:hidden">
<div class="py-3 px-2">
<h5 class="font-semibold">Table of Contents</h5>
<div class="text-sm py-1 px-2"><nav id="TableOfContents">
<ul>
<li><a href="#prerequisite">Prerequisite</a></li>
<li><a href="#the-cartpole-problem">The Cartpole Problem</a>
<ul>
<li><a href="#state">State</a></li>
<li><a href="#action-space">Action space</a></li>
<li><a href="#reward">Reward</a></li>
<li><a href="#when-is-it-solved">When is it solved?</a></li>
</ul>
</li>
<li><a href="#required-dependencies">Required Dependencies</a>
<ul>
<li><a href="#on-colab">On Colab</a></li>
</ul>
</li>
<li><a href="#imports">Imports</a></li>
<li><a href="#configurable-parameters">Configurable Parameters</a></li>
<li><a href="#setting-up-the-environment">Setting up the Environment</a>
<ul>
<li><a href="#on-colab-1">On Colab</a></li>
</ul>
</li>
<li><a href="#model">Model</a></li>
<li><a href="#create-trainer">Create Trainer</a></li>
<li><a href="#attach-handlers-to-run-on-specific-events">Attach handlers to run on specific events</a></li>
<li><a href="#run-trainer">Run Trainer</a>
<ul>
<li><a href="#on-colab-2">On Colab</a></li>
</ul>
</li>
</ul>
</nav></div>
</div>
</aside>
</div>
<script src="/_hugo/js/app.319fb8141aac723ecc1c6db29dd5a576.min.js" defer=""></script>
<script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script>
<script>fetch('https://api.github.com/repos/pytorch/ignite/releases/latest').then(a=>a.json()).then(a=>{docsearch({container:'#docsearch',appId:'7EWYE1JCT3',apiKey:'841e93e60c16975ba1bd8c7c716eed82',indexName:'pytorch-ignite',searchParameters:{facetFilters:[[`version:${a.tag_name}`,'tags:Website']]}})})</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-NQNJSZEFB4"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-NQNJSZEFB4',{anonymize_ip:!1})}</script>

</body></html>